{ 
   "reply":{ 
      "total_count":1,
      "result_count":1,
      "incidents":[ 
         { 
            "incident_id":"150",
            "creation_time":1577024425126,
            "modification_time":1577024425126,
            "detection_time":null,
            "status":"new",
            "severity":"medium",
            "description":"'Memory Corruption Exploit' generated by XDR Agent detected on host Sudajrem",
            "assigned_user_mail":null,
            "assigned_user_pretty_name":null,
            "alert_count":1,
            "low_severity_alert_count":0,
            "med_severity_alert_count":1,
            "high_severity_alert_count":0,
            "user_count":1,
            "host_count":1,
            "notes":null,
            "resolve_comment":null,
            "manual_severity":null,
            "manual_description":null,
            "xdr_url":"https://1fdc2838-df01-4fc4-ad8a-7b04c04d2836.xdr-qa2.us.paloaltonetworks.com/incident-view/150",
            "starred":false,
            "hosts":[ 
               "Sudajrem:00000000000000008e0eb54603d7e52a"
            ],
            "users":[ 

            ],
            "incident_sources":[ 
               "XDR Agent"
            ]
         }
      ]
   }
}

    "reply": {
        "incident": {
            "incident_id": "141",
            "creation_time": 1576770930325,
            "modification_time": 1576770930325,
            "detection_time": null,
            "status": "new",
            "severity": "medium",
            "description": "'Memory Corruption Exploit' generated by XDR Agent detected on host Test",
            "assigned_user_mail": 'test@test.com',
            "assigned_user_pretty_name": 'Hello World',
            "alert_count": 1,
            "low_severity_alert_count": 0,
            "med_severity_alert_count": 1,
            "high_severity_alert_count": 0,
            "user_count": 1,
            "host_count": 1,
            "notes": null,
            "resolve_comment": 'This incident is resolved',
            "manual_severity": low,
            "manual_description": null,
            "xdr_url": "https://{tenant_id}.xdr.us.paloaltonetworks.com/incident-view/141",
            "starred": false,
            "hosts": [
                "Test:7dd623a31876ab1f"
            ],
            "users": [],
            "alert_sources": [
                "XDR Agent"
            ]
        },
        "alerts": {
            "total_count": 1,
            "data": [
                {
                    "alert_id": "589",
                    "detection_timestamp": 1576511550329,
                    "source": "XDR Agent",
                    "severity": "medium",
                    "name": "Memory Corruption Exploit",
                    "category": "Exploit",
                    "action": "BLOCKED",
                    "action_pretty": "Prevented (Blocked)",
                    "endpoint_id": "7dd623a31876ab1f",
                    "description": "ROP chain utilization attempt detected",
                    "host_ip": "55.164.72.47",
                    "host_name": "Pokjutu",
                    "user_name": null,
                    "event_type": "Process Execution",
                    "actor_process_image_name": "virus.exe",
                    "actor_process_command_line": "c:\\V7527E7L\\BUJ0C6YB\\RO4B117H\\virus.exe /Y Test",                    
                    "fw_app_id": null,
                    "is_whitelisted": "No",
                    "starred": false
                }
            ]
        },
        "network_artifacts": {
            "total_count": 3,
            "data": [{ 
            'type':'IP',
            'alert_count':2,
            'is_manual':false,
            'network_domain':'network_domain_example.com',
            'network_remote_ip':'13.13.13.13',
            'network_remote_port':10,
            'network_country':null,

         },
         { 
            'type':'DOMAIN',
            'alert_count':1,
            'is_manual':false,
            'network_domain':'network_domain_example.com',
            'network_remote_ip':'13.13.13.13',
            'network_remote_port':10,
            'network_country':null,

         },
         { 
            'type':'DOMAIN',
            'alert_count':1,
            'is_manual':false,
            'network_domain':'network_domain_example.com',
            'network_remote_ip':'13.13.13.13',
            'network_remote_port':10,
            'network_country':null,

         }]
        },
        "file_artifacts": {
            "total_count": 1,
            "data": [
                {
                    "type": "HASH",
                    "alert_count": 1,
                    "is_manual": false,
                    "is_malicious": false,
                    "is_process": true,
                    "file_name": "virus.exe",
                    "file_sha256": "27a938b0b26eeabfed9fcdb658b51bd53fe38c0b2529da39489fc0a5bf127983",
                    "file_signature_status": "SIGNATURE_UNAVAILABLE",
                    "file_signature_vendor_name": null,
                    "file_wildfire_verdict": "UNKNOWN"
                }
            ]
        }
    }
}
{ 
   "reply":{ 
      "total_count":1,
      "result_count":1,
      "alerts":[ 
         {
            "external_id":"3d5d6200-3c4e-4ed8-9335-c88f49fec",
            "severity":"high",
            "matching_status":"MATCHED",
            "end_match_attempt_ts":null,
            "local_insert_ts":1597931987,
            "bioc_indicator":"[{\"pretty_name\":\"Process\",\"data_type\":null,\"render_type\":\"entity\",\"entity_map\":null,\"dml_ui\":false},{\"pretty_name\":\"action type\",\"data_type\":null,\"render_type\":\"attribute\",\"entity_map\":null,\"dml_type\":null},{\"pretty_name\":\"=\",\"data_type\":null,\"render_type\":\"operator\",\"entity_map\":null},{\"pretty_name\":\"execution\",\"data_type\":null,\"render_type\":\"value\",\"entity_map\":null},{\"pretty_name\":\"AND\",\"data_type\":null,\"render_type\":\"connector\",\"entity_map\":null},{\"pretty_name\":\"target process name\",\"data_type\":\"TEXT\",\"render_type\":\"attribute\",\"entity_map\":\"attributes\",\"dml_type\":null},{\"pretty_name\":\"=\",\"data_type\":null,\"render_type\":\"operator\",\"entity_map\":\"attributes\"},{\"pretty_name\":\"virus.exe\",\"data_type\":null,\"render_type\":\"value\",\"entity_map\":\"attributes\"}]",
            "matching_service_rule_id":"414",
            "attempt_counter":null,
            "bioc_category_enum_key":null,
            "case_id":11,
            "is_whitelisted":false,
            "starred":false,
            "deduplicate_tokens":null,
            "filter_rule_id":null,
            "mitre_technique_id_and_name":"",
            "mitre_tactic_id_and_name":"",
            "agent_version":null,
            "agent_device_domain":null,
            "agent_fqdn":null,
            "agent_os_type":"Windows",
            "agent_os_sub_type":"Windows 7",
            "agent_data_collection_status":null,
            "mac":"",
            "agent_is_vdi":null,
            "event_sub_type":1,
            "module_id":null,
            "association_strength":null,
            "dst_association_strength":null,
            "story_id":null,
            "event_id":"UZYuULJM1QyUIsnXYuC9uw==",
            "event_type":"Process Execution",
            "event_timestamp":1597657881618,
            "actor_process_instance_id":"AxrZzCx9SfAfQEdGA==",
            "actor_process_image_path":"c:\\MI3XZ5QO\\ProcessNameADHUCNHN.ocx",
            "actor_process_image_name":"ProcessNameADHUCNHN.ocx",
            "actor_process_command_line":"c:\\MI3XZ5QO\\ProcessNameADHUCNHN.ocx /i Marc Lyons /rnapizec",
            "actor_process_signature_status":"Unsigned",
            "actor_process_signature_vendor":"N/A",
            "actor_process_image_sha256":"c11c7f6962fcc7d164d8e8a240b7cd3deb0c6b6b19616bbc674c3",
            "actor_process_image_md5":"914a502a9a71887f0f2cf74b",
            "actor_process_causality_id":"AxrZz6Cx9SfAfQEdGA==",
            "actor_causality_id":"AxrZz6Cx9SfAfQEdGA==",
            "actor_process_os_pid":"1368",
            "actor_thread_thread_id":90,
            "causality_actor_process_image_name":"ProcessNameADHUCNHN.ocx",
            "causality_actor_process_command_line":"c:\\MI3XZ5QO\\ProcessNameADHUCNHN.ocx /i Marc Lyons /rnapizec",
            "causality_actor_process_image_path":"c:\\MI3XZ5QO\\ProcessNameADHUCNHN.ocx",
            "causality_actor_process_signature_vendor":"N/A",
            "causality_actor_process_signature_status":"Unsigned",
            "causality_actor_causality_id":"AxrZzua6l6Cx9SfAfQEdGA==",
            "causality_actor_process_execution_time":1597657866000,
            "causality_actor_process_image_md5":"914a502a92372c7a87f0f2cf74b",
            "causality_actor_process_image_sha256":"c11c7f6962fcc837c098cf9a3e8a240b7cd3deb0c6b6b19616bbc674c3",
            "action_file_path":null,
            "action_file_name":null,
            "action_file_md5":null,
            "action_file_sha256":null,
            "action_file_macro_sha256":null,
            "action_registry_data":null,
            "action_registry_key_name":null,
            "action_registry_value_name":null,
            "action_registry_full_key":null,
            "action_local_ip":null,
            "action_local_port":null,
            "action_remote_ip":null,
            "action_remote_port":null,
            "action_external_hostname":null,
            "action_country":null,
            "action_process_instance_id":"9ntqotspowwsOmPjd37P9A==",
            "action_process_causality_id":"AxrZzua6l6Cx9SfAfQEdGA==",
            "action_process_image_name":"virus.exe",
            "action_process_image_sha256":"10219351714c57f2f958ceda4dd1246ec2fd9af23b8e3d46b5107c3d3842017a",
            "action_process_image_command_line":"c:\\QFFA4N2X\\B30AXHQK\\MUFA7RA2\\test.exe /M Test /bsevo",
            "action_process_signature_status":"Unsigned",
            "action_process_signature_vendor":"N/A",
            "os_actor_effective_username":null,
            "os_actor_process_instance_id":null,
            "os_actor_process_image_path":null,
            "os_actor_process_image_name":null,
            "os_actor_process_command_line":null,
            "os_actor_process_signature_status":"N/A",
            "os_actor_process_signature_vendor":"N/A",
            "os_actor_process_image_sha256":null,
            "os_actor_process_causality_id":null,
            "os_actor_causality_id":null,
            "os_actor_process_os_pid":null,
            "os_actor_thread_thread_id":null,
            "fw_app_id":null,
            "fw_interface_from":null,
            "fw_interface_to":null,
            "fw_rule":null,
            "fw_rule_id":null,
            "fw_device_name":null,
            "fw_serial_number":null,
            "fw_url_domain":null,
            "fw_email_subject":null,
            "fw_email_sender":null,
            "fw_email_recipient":null,
            "fw_app_subcategory":null,
            "fw_app_category":null,
            "fw_app_technology":null,
            "fw_vsys":null,
            "fw_xff":null,
            "fw_misc":null,
            "fw_is_phishing":"N/A",
            "dst_agent_id":null,
            "dst_causality_actor_process_execution_time":null,
            "alert_id":"17",
            "detection_timestamp":1597657881618,
            "name":"Virus",
            "category":"Credential Access",
            "endpoint_id":"b72993d1582a8602",
            "description":"Process action type = execution AND target process name = test.exe",
            "host_ip":[
               "231.00.000.219",
               "21.000.000.104",
               "88.000.000.190"
            ],
            "host_name":"Lakofru",
            "source":"XDR BIOC",
            "action":"DETECTED",
            "action_pretty":"Detected",
            "user_name":"User_mflx"
         }
      ]
   }
}
{ 
   "reply":[ 
      { 
         "agent_id":"580a39cd3b9043f1a03488f24b0c5810",
         "agent_status":"LOST",
         "host_name":"EX2",
         "agent_type":"Server",
         "ip":204881550
      },
      { 
         "agent_id":"fe2cda7a9d7448818184c39cc74454df",
         "agent_status":"LOST",
         "host_name":"EX1",
         "agent_type":"Server",
         "ip":204881552
      },
      { 
         "agent_id":"953688735d4944f691376af9b9ee3593",
         "agent_status":"CONNECTED",
         "host_name":"DESKTOP-JE8JS25",
         "agent_type":"Workstation",
         "ip":3232270645
      },
      { 
         "agent_id":"953688735d4944y691378af9b9ee3593",
         "agent_status":"CONNECTED",
         "host_name":"DESKTOP-JE8JS25",
         "agent_type":"Workstation",
         "ip":3232270645
      },
      { 
         "agent_id":"953688735a4944f691378af9b9ee3593",
         "agent_status":"CONNECTED",
         "host_name":"DESKTOP-JE8JS25",
         "agent_type":"Workstation",
         "ip":3232270645
      },
      { 
         "agent_id":"b49bd38377b847df8aea0583a512e9c6",
         "agent_status":"LOST",
         "host_name":"TLV-1571139697",
         "agent_type":"Workstation",
         "ip":169088002
      },
      { 
         "agent_id":"51888e4ce3214c63b39d054bd073b93a",
         "agent_status":"DISCONNECTED",
         "host_name":"DESKTOP-JE8JS25",
         "agent_type":"Workstation",
         "ip":3232270753
      }
   ]
   { 
   "reply":[ 
      { 
         "agent_id":"580a39cd3b9043f1a03488f24b0c5810",
         "agent_status":"LOST",
         "host_name":"EX2",
         "agent_type":"Server",
         "ip":204881550
      },
      { 
         "agent_id":"fe2cda7a9d7448818184c39cc74454df",
         "agent_status":"LOST",
         "host_name":"EX1",
         "agent_type":"Server",
         "ip":204881552
      },
      { 
         "agent_id":"953688735d4944f691376af9b9ee3593",
         "agent_status":"CONNECTED",
         "host_name":"DESKTOP-JE8JS25",
         "agent_type":"Workstation",
         "ip":3232270645
      },
      { 
         "agent_id":"953688735d4944y691378af9b9ee3593",
         "agent_status":"CONNECTED",
         "host_name":"DESKTOP-JE8JS25",
         "agent_type":"Workstation",
         "ip":3232270645
      },
      { 
         "agent_id":"953688735a4944f691378af9b9ee3593",
         "agent_status":"CONNECTED",
         "host_name":"DESKTOP-JE8JS25",
         "agent_type":"Workstation",
         "ip":3232270645
      },
      { 
         "agent_id":"b49bd38377b847df8aea0583a512e9c6",
         "agent_status":"LOST",
         "host_name":"TLV-1571139697",
         "agent_type":"Workstation",
         "ip":169088002
      },
      { 
         "agent_id":"51888e4ce3214c63b39d054bd073b93a",
         "agent_status":"DISCONNECTED",
         "host_name":"DESKTOP-JE8JS25",
         "agent_type":"Workstation",
         "ip":3232270753
      }
   ]
   "reply":{
   	  "total_count": 10,	 
      "result_count":1,
      "violations":[ 
         { 
            "hostname":"TLV-1573665448",
            "username":"test",
            "ip":"10.20.20.3",
            "timestamp":1576260019000,
            "violation_id":11,
            "type":"Disk Drive",
            "vendor_id":"0x0999",
            "vendor":"0x0999",
            "product_id":"0x10036",
            "product":"0x10036",
            "serial":"8888889",
            "endpoint_id":"b49bd38477b847df8aea0588a512e9c6"
         }
      ]
   }
   { 
   "reply":{ 
      "windows":[ 
         "6.1.0.15515",
         "5.0.7.16157",
         "5.0.3.38894",
         "5.0.6.4846"
      ],
      "linux":[ 
         "5.0.4.1179",
         "5.0.6.1202",
         "6.1.0.1629",
         "5.0.5.1193"
      ],
      "macos":[ 
         "5.0.2.1146",
         "6.1.0.1631",
         "5.0.4.1179"
      ]
   }
}
{ 
   "reply":{ 
      "distribution_id":"26748677e9f44104b04bfee0aac4eb20"
   }
}

{
    "reply": {
        "status": (“Completed”)
    }
}
{
    "reply": {
        "distribution_url": {DOWNLOAD_URL}
    }
    "reply": {
    		"action_id":"[ID value]",
    		"status": "1",
    		"endpoints_count": "673"
        }

	{
    "reply": {
    	"data": {
            "59b7211148c94c39b88b44ffddb66d47": "https:///api/webapp/download/eyJ0eXAiOiJKV1QiLC"
            }
       }
	   
    "reply": {
    		"action_id":"[ID value]",
    		"status": "1",
    		"endpoints_count": "673"
        }
		{ 
   "reply":[ 
      { 
         "endpoint_id":"51888e4ce9214c63b39d054bd073b93a",
         "file_path":"C:\\Users\\XDR\\Desktop\\test_x64.msi",
         "file_hash":"8D3508904324A304D2CC2375B393E59BBBC78C9C5903B8B23C5095F6D75",
         "status":false
      }
   ]
     "reply":{
      "result_count":24,
      "scripts":[
         {
            "script_id":156,
            "name":"list_directories",
            "description":"List all directories under path",
            "modification_date":1585074627259,
            "created_by":"Palo Alto Networks",
            "is_high_risk":false,
            "windows_supported":true,
            "linux_supported":true,
            "macos_supported":true,
            "script_uid":"43973479d389fe99b6db88eaee40"
         },
         {
            "script_id":154,
            "name":"test 1",
            "description":"test",
            "modification_date":1583052236449,
            "created_by":"User 1",
            "is_high_risk":false,
            "windows_supported":true,
            "linux_supported":false,
            "macos_supported":false,
            "script_uid":"89169869c13e9bbfc92d1d6be1f9"
         },
         {
            "script_id":153,
            "name":"test 2",
            "description":"test 2",
            "modification_date":1582709343498,
            "created_by":"User 2",
            "is_high_risk":false,
            "windows_supported":true,
            "linux_supported":true,
            "macos_supported":true,
            "script_uid":"904f89d8dc29975bfbb0c8b43b48"
         }
      ]
   }
     "reply":{
      "script_id":156,
      "name":"list_directories",
      "description":"List all directories under path",
      "modification_date":1585074627259,
      "created_by":"Palo Alto Networks",
      "is_high_risk":false,
      "windows_supported":true,
      "linux_supported":true,
      "macos_supported":true,
      "script_uid":"43973479dc7e99b6db88eaee40",
      "entry_point":"run",
      "script_input":[
         {
            "name":"path",
            "type":"string"
         },
         {
            "friendly_name":"Number of levels",
            "name":"num_levels",
            "type":"number"
         }
      ],
      "script_output_type":   "dictionary",
   	  "script_output_dictionary_definitions":   [
         {
            "friendly_name":"Number Of Processes",
            "name":"output_2",
            "type":"number"
         },
         {
            "friendly_name":"Name",
            "name":"output_1",
            "type":"string"
         }
      ]
   }
    "reply":{
      "general_status":"PENDING",
      "endpoints_pending":1,
      "endpoints_canceled":0,
      "endpoints_in_progress":0,
      "endpoints_timeout":0,
      "endpoints_failed":0,
      "endpoints_completed_successfully":0,
      "endpoints_pending_abort":0,
      "endpoints_aborted":0,
      "endpoints_expired":0
   }
   
   
   "reply":{
      "script_name":"snippet script",
      "script_description":null,
      "script_parameters":[

      ],
      "date_created":"2020-03-29 13:21:59",
      "scope":"win_10and 21 other endpoints",
      "error_message":"",
      "results":[
         {
            "endpoint_name":"lin-2019-11-13---10-21",
            "endpoint_ip_address":[
               "10.000.0.8"
            ],
            "endpoint_status":"LOST",
            "domain":"aaaa",
            "endpoint_id":"06c62c9626d445c7b341abd2e7063d",
            "execution_status":"PENDING",
            "standard_output":null,
            "retrieved_files":0,
            "failed_files":0,
            "retention_date":null
         },
         {
            "endpoint_name":"ib-1574868757",
            "endpoint_ip_address":[
               "10.000.0.0"
            ],
            "endpoint_status":"LOST",
            "domain":"aaaa",
            "endpoint_id":"bf8f49eeb6e1469b93804e209d29e6",
            "execution_status":"PENDING",
            "standard_output":null,
            "retrieved_files":0,
            "failed_files":0,
            "retention_date":null
         },
         {
            "endpoint_name":"win10-x64-bknd",
            "endpoint_ip_address":[
               "10.000.30.200"
            ],
            "endpoint_status":"DISCONNECTED",
            "domain":"WORKGROUP",
            "endpoint_id":"cc59f30f4de64ea4af3910a9c66ed2e6",
            "execution_status":"PENDING",
            "standard_output":null,
            "retrieved_files":0,
            "failed_files":0,
            "retention_date":null
         }
      ]
   }
}
{    "reply": "import os\nimport sys\nimport traceback\n\n\ndef run(path, num_levels):\n\tpath = os.path.expanduser(path)\n\tpath = os.path.expandvars(path)\n\treturn scan_directory_recursive(path, num_levels)\n\n\ndef scan_directory_recursive(directory, level):\n\tif level == 0:\n\t\treturn []\n\n\tsubfolders = []\n\ttry:\n\t\twith os.scandir(directory) as entries:\n\t\t\tfor f in entries:\n\t\t\t\ttry:\n\t\t\t\t\tif f.is_dir():\n\t\t\t\t\t\tsubfolders.append(f.path)\n\t\t\t\texcept (OSError,PermissionError):\n\t\t\t\t\tsys.stderr.write(f\"Failed access <{f.path}>\\n\")\n\n\t\tfor folder in list(subfolders):\n\t\t    subfolders.extend(scan_directory_recursive(folder, level-1))\n\texcept Exception:\n\t\tsys.stderr.write(f\"Failed scanning directory: <{directory}>, error: {traceback.format_exc()}\")\n\n\treturn subfolders\n"}
{ 
   "reply":{
      "total_count": 10, 
      "result_count":1,
      "data":[ 
         { 
            "TIMESTAMP":1572427859369.953,
            "RECEIVEDTIME":1572427936626.636,
            "ENDPOINTID":"5a52bdb151444c7fa7ccd1cfb561bd3c",
            "ENDPOINTNAME":"DESKTOP-4LC01UI",
            "DOMAIN":"WORKGROUP",
            "TRAPSVERSION":"5.0.7.16157",
            "CATEGORY":"Status",
            "TYPE":"Agent Status",
            "SUBTYPE":"Fully Protected",
            "RESULT":null,
            "REASON":null,
            "DESCRIPTION":"DESKTOP-4LC01UI is fully protected"
         }
      ]
   }
   
    
   "reply":{
   	  "total_count":1,	 
      "result_count":1,
      "data":[ 
         { 
            "AUDIT_ID":1,
            "AUDIT_OWNER_NAME":"User Name",
            "AUDIT_OWNER_EMAIL":"uname@paloaltonetworks.com",
            "AUDIT_ASSET_JSON":"{}",
            "AUDIT_ASSET_NAMES":"",
            "AUDIT_HOSTNAME":null,
            "AUDIT_RESULT":"SUCCESS",
            "AUDIT_REASON":null,
            "AUDIT_DESCRIPTION":null,
            "AUDIT_ENTITY":"AUTH",
            "AUDIT_ENTITY_SUBTYPE":"Login",
            "AUDIT_SESSION_ID":null,
            "AUDIT_CASE_ID":null,
            "AUDIT_INSERT_TIME":1565074114053
         }
      ]
   }